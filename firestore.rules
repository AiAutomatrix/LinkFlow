
rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    
    // User profiles
    match /users/{userId} {
      // Allow anyone to read a user's public profile data.
      // This is necessary for the /u/[username] pages to work.
      allow read: if true;
      
      // Allow a user to create, update, and delete their own profile.
      allow write: if request.auth != null && request.auth.uid == userId;
    }
    
    // User links
    match /users/{userId}/links/{linkId} {
        // Allow anyone to read the links for a public profile.
        allow read: if true;

        // Allow an authenticated user to create, update, and delete their own links.
        allow write: if request.auth != null && request.auth.uid == userId;
    }
  }
}
